name: Code Scan


on:
  push:
    branches:
      - master


jobs:
  blacklock-scan:
    runs-on: ubuntu-latest
    container:
      image: blacklocksec/code-scanner:staging  # Use the scanner image
      options: > 
        --volume "${{ github.workspace }}:/app" 
        --volume "/bl_reports:/bl_reports"


    env:
      SONAR_PROJECTKEY: ${{ secrets.SONAR_PROJECTKEY }}
      SONAR_HOST_URL: ${{ secrets.SONAR_HOST_URL }}
      SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}


    steps:
      - name: Checkout Code
        uses: actions/checkout@v4


      - name: Run Blacklock Code Scanner
        run: /usr/local/bin/run.sh  # Adjust the script location if needed
